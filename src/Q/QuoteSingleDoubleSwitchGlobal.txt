
Sub QuoteSingleDoubleSwitchGlobal()
' Paul Beverley - Version 23.05.25
' Changes double quotes to single and vice versa, avoiding apostrophes

myTrack = ActiveDocument.TrackRevisions
ActiveDocument.TrackRevisions = False

myColour = wdBrightGreen
' myColour = wdTurquoise

myFind = """,',!t,!ve,!m,!n,!s,!d,!r,!l,s!,',zczc"
myFind = Replace(myFind, "!", ChrW(8217))

myReplace = myReplace & "zczc,',^&,^&,^&,^&,^&,^&,^&,^&,^&,"",'"
fnd = Split(myFind, ",")
rpl = Split(myReplace, ",")

oldColour = Options.DefaultHighlightColorIndex
Options.DefaultHighlightColorIndex = myColour

Set rngT = ActiveDocument.Content
If ActiveDocument.Footnotes.Count > 0 Then _
  Set rngF = ActiveDocument.StoryRanges(wdFootnotesStory)
If ActiveDocument.Endnotes.Count > 0 Then _
  Set rnge = ActiveDocument.StoryRanges(wdEndnotesStory)

For i = 0 To UBound(fnd)
  Debug.Print fnd(i), rpl(i)
  With rngT.Find
    .ClearFormatting
    .Replacement.ClearFormatting
    .Text = fnd(i)
    If rpl(i) = """" Then .Font.StrikeThrough = False
    .Wrap = wdFindContinue
    .Replacement.Text = rpl(i)
    .MatchCase = False
    .MatchWildcards = False
    If rpl(i) = "^&" Then .Replacement.Font.StrikeThrough = True
    If Asc(fnd(i)) = Asc("s") Then .Replacement.Highlight = True
    .Execute Replace:=wdReplaceAll
  End With
  DoEvents
  If ActiveDocument.Footnotes.Count > 0 Then
    With rngF.Find
      .ClearFormatting
      .Replacement.ClearFormatting
      .Text = fnd(i)
      If rpl(i) = """" Then .Font.StrikeThrough = False
      .Wrap = wdFindContinue
      .Replacement.Text = rpl(i)
      .MatchCase = False
      .MatchWildcards = False
      If rpl(i) = "^&" Then .Replacement.Font.StrikeThrough = True
      If Asc(fnd(i)) = Asc("s") Then .Replacement.Highlight = True
      .Execute Replace:=wdReplaceAll
    End With
    DoEvents
  End If
  If ActiveDocument.Endnotes.Count > 0 Then
    With rnge.Find
      .ClearFormatting
      .Replacement.ClearFormatting
      .Text = fnd(i)
      If rpl(i) = """" Then .Font.StrikeThrough = False
      .Wrap = wdFindContinue
      .Replacement.Text = rpl(i)
      .MatchCase = False
      .MatchWildcards = False
      If rpl(i) = "^&" Then .Replacement.Font.StrikeThrough = True
      If Asc(fnd(i)) = Asc("s") Then .Replacement.Highlight = True
      .Execute Replace:=wdReplaceAll
    End With
    DoEvents
  End If
Next i
Set rng = ActiveDocument.Content
With rng.Find
  .ClearFormatting
  .Replacement.ClearFormatting
  .Wrap = wdFindContinue
  .Text = "^0145^0148"
  .Replacement.Text = "^0145^0147"
  .MatchWildcards = False
  .Execute Replace:=wdReplaceAll
  DoEvents
  
  .Text = "^0148^0145"
  .Replacement.Text = "^0148^0145"
  .Execute Replace:=wdReplaceAll
  
  .Text = "^0145^0146"
  .Replacement.Text = "^0145^0147"
  .Execute Replace:=wdReplaceAll
  
  .Text = "^0148^0145"
  .Replacement.Text = "^0148^0146"
  .Execute Replace:=wdReplaceAll


'Delete this when finished!

  .Text = """"
  .Replacement.Text = "^&"
  .Replacement.Highlight = True
  .Execute Replace:=wdReplaceAll


Options.DefaultHighlightColorIndex = wdYellow
  
  .Text = "'"
  .Replacement.Text = "^&"
  .Replacement.Highlight = True
  .Execute Replace:=wdReplaceAll

Options.DefaultHighlightColorIndex = wdTurquoise
  
  .Text = "^0146t"
  .Replacement.Text = "^&"
  .Replacement.Highlight = True
  .Execute Replace:=wdReplaceAll
  
  .Text = "^0146s"
  .Replacement.Text = "^&"
  .Replacement.Highlight = True
  .Execute Replace:=wdReplaceAll
End With

rngT.Font.StrikeThrough = False
If ActiveDocument.Footnotes.Count > 0 Then _
  rngF.Font.StrikeThrough = False
If ActiveDocument.Endnotes.Count > 0 Then _
  rnge.Font.StrikeThrough = False
Options.DefaultHighlightColorIndex = oldColour
ActiveDocument.TrackRevisions = myTrack
End Sub

