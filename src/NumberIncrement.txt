Sub NumberIncrement()
' Paul Beverley - Version 31.07.21
' Adds one to the following number (or increases the letter)

myJump = 1

goNext = False

lookAfterSelection = True

trackIt = True

doLettersToo = True
searchRange = 150

If lookAfterSelection = False Then
  Selection.Collapse wdCollapseStart
Else
  Selection.Collapse wdCollapseEnd
End If

searchChars = "0123456789"
myTrack = ActiveDocument.TrackRevisions
If trackIt = False Then ActiveDocument.TrackRevisions = False

i = 0
myStart = Selection.Start
Set rng = ActiveDocument.Range(myStart, myStart + 1)
If Selection.End = Selection.Start Or Val(Selection) = 0 Then
  While InStr(searchChars, rng.Text) = 0
    i = i + 1
    rng.Start = myStart + i
    rng.End = myStart + i + 1
    DoEvents
    If i = searchRange Then
      Beep
      GoTo CleanExit
    End If
  Wend
  rng.Select
  myEnd = Selection.Start
  Set rng = ActiveDocument.Range(myEnd, myEnd + 1)
  i = 0
  While InStr(searchChars, rng.Text) > 0
    i = i + 1
    rng.Start = myEnd + i
    rng.End = myEnd + i + 1
    DoEvents
  Wend
  Selection.End = myEnd + i
End If

Selection.TypeText Trim(Str(Val(Selection) + myJump))
Selection.Start = myEnd
Selection.End = myEnd
doLettersToo = False

CleanExit:
If doLettersToo = True Then
  Selection.End = Selection.Start + 1
  Selection.TypeText ChrW(AscW(Selection) + 1)
  Selection.MoveLeft , 1
End If
ActiveDocument.TrackRevisions = myTrack
If goNext = True Then Call FindFwd
End Sub


