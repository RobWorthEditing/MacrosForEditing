Sub CaseNextWord()
' Paul Beverley - Version 27.10.21
' Changes case of initial letter of next word or selection

trackIt = True
' If an area of text is selected (more than one character) ...
If Selection.End > Selection.Start Then
  myText = Selection
  myUpper = True
  ' Count numbers of upper and lower case characters
  ' to decide which way to switch the case.
  myUpper = 0: myLower = 0
  For myCount = 1 To Len(myText)
    myChar = Asc(Mid(myText, myCount, 1))
    If myChar > 96 And myChar < 123 Then myLower = myLower + 1
    If myChar > 64 And myChar < 91 Then myUpper = myUpper + 1
  Next myCount
  If myUpper = 0 Then
    Selection.Range.Case = wdTitleWord
  Else
    Selection.Range.Case = wdLowerCase
  End If
Else

' If no text is selected ...
' Find next word start
  Set rng = Selection.Range.Duplicate
  rng.End = rng.End + 1
  Do While UCase(rng) <> LCase(rng) Or InStr("0123456789", rng) > 0
    rng.Start = rng.Start + 1
    rng.End = rng.End + 1
    DoEvents
  Loop
  Do While UCase(rng) = LCase(rng)
    rng.Start = rng.Start + 1
    rng.End = rng.End + 1
    DoEvents
  Loop
  rng.Select
  If trackIt = False Then
    Selection.Range.Case = wdToggleCase
    Selection.MoveRight Unit:=wdCharacter, Count:=1
  Else
    myChar = Selection
    If UCase(myChar) = myChar Then
      myChar = LCase(myChar)
    Else
      myChar = UCase(myChar)
    End If
    Selection.Text = myChar
    Selection.Collapse wdCollapseEnd
  End If
End If
End Sub

