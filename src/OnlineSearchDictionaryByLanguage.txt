Sub OnlineSearchDictionaryByLanguage()
' Version 2022-03-08
' Adapted by Rob Worth from Fetch macros by Paul Beverley

' Launches web browser to search online dictionary based on the LanguageID of the selected text

' To add another language and dictionary find the LanguageID from the link below 
' and add the search url from the dictionary you require
' then copy one of the ElseIf line pairs from the code below and add it in.
' List of LanguageID constants at https://docs.microsoft.com/en-us/office/vba/api/word.wdlanguageid

If Len(Selection) = 1 Then Selection.Expand wdWord

' Chooses dictionary url based on the LanguageID of the selection
' The default is the OED at lexico.com if no language detected
If Selection.Range.LanguageID = wdEnglishUS Then
   mySite = "https://www.merriam-webster.com/dictionary/"
ElseIf Selection.Range.LanguageID = wdEnglishAUS Then
   mySite = "https://www.macquariedictionary.com.au/features/word/search/"
Else
   mySite = "https://www.lexico.com/definition/"
End If

mySubject = Trim(Selection)
mySubject = Replace(mySubject, " ", "+")
mySubject = Replace(mySubject, "&", "%26")
mySubject = Replace(mySubject, ChrW(8217), "'")
Set newLink = ActiveDocument.Hyperlinks.Add(Anchor:=Selection.Range, _
   Address:=mySite & mySubject)
newLink.Follow
ActiveDocument.Undo
End Sub
