
Sub MacroFetchPlus()
' Paul Beverley - Version 22.05.25
' Fetches the macro named in the clipboard or at the cursor

' Does this look like a macro?
Set rng = Selection.Range.Duplicate
rng.Collapse wdCollapseEnd
rng.MoveEnd , 1
ch = rng.Text
If LCase(ch) = UCase(ch) Then
  Selection.Collapse wdCollapseStart
  myStart = Selection.Start
  Selection.Paste
  Selection.Start = myStart
  myMacroName = Trim(Selection)
  WordBasic.EditUndo

  If InStr(myMacroName, " ") > 0 Or Len(myMacroName) > 20 Then
    Selection.MoveLeft , 1
    Selection.Expand wdWord
    myMacroName = Trim(Selection)
  End If
Else
  Selection.MoveLeft , 1
  Selection.Expand wdWord
  myMacroName = Trim(Selection)
End If
Selection.Collapse wdCollapseEnd
Debug.Print myMacroName
myFolder = Left(myMacroName, 1)
myName = ""
For i = 1 To Len(myMacroName)
  ch = Mid(myMacroName, i, 1)
  If AscW(ch) > 128 Then
    myName = myName & "%" & Hex(AscW(ch))
    myFolder = "ES"
  Else
    myName = myName & ch
  End If
Next i
myFullName = "https://www.wordmacrotools.com/macros/" & myFolder & "/" & myName
Selection.InsertAfter Text:=myFullName
Selection.Range.Copy
WordBasic.EditUndo

thisIsMacro = True
ch1 = Left(myMacroName, 1)
If LCase(ch1) = ch1 Then thisIsMacro = False
For i = 1 To Len(myMacroName) - 3
  ch = Mid(myMacroName, i, 1)
  If LCase(ch) = UCase(ch) Then
    thisIsMacro = False
    Exit For
  End If
  DoEvents
Next i

GotMacro = True
ch1 = Left(myMacroName, 1)
If LCase(ch1) = ch1 Then GotMacro = False
For i = 1 To Len(myMacroName) - 3
  ch = Mid(myMacroName, i, 1)
  If LCase(ch) = UCase(ch) Then
    GotMacro = False
    Exit For
  End If
  DoEvents
Next i

If Len(myMacroName) > 3 And thisIsMacro = True Then
  myFolder = Left(myMacroName, 1)
  myFullName = "https://www.wordmacrotools.com/macros/" & _
       myFolder & "/" & myMacroName
  ActiveDocument.FollowHyperlink Address:=myFullName
End If
Selection.Collapse wdCollapseStart
End Sub

